<div class="share-wrapper">
  <h1>{{ 'share.title' | translate }}</h1>

  @if (loading()) {
    <p>{{ 'share.loading' | translate }}</p>
  } @else if (loadError()) {
    <div class="error">
      {{ loadError() | translate }}
    </div>
  } @else if (object()) {
    <div class="card">
      <h2>{{ object()?.project_name }}</h2>
      <p class="address">
        @if (object()?.address?.level) {
          <span>{{ 'objects.level' | translate }}: {{ object()?.address?.level }}</span>
        }
        @if (object()?.address?.door_number) {
          <span>{{ 'objects.doorNumber' | translate }}: {{ object()?.address?.door_number }}</span>
        }
        @if (object()?.address?.postal_code) {
          <span>{{ object()?.address?.postal_code }}</span>
        }
      </p>
      @if (object()?.note) {
        <p class="note">
          {{ object()?.note }}
        </p>
      }
      <p class="status">
        {{ 'share.currentStatus' | translate }}: {{ formatStatus(object()?.status || defaultStatus) | translate }}
      </p>
    </div>

    <div class="decision">
      <label for="decision-note">
        {{ 'share.reasonLabel' | translate }}
      </label>
      <textarea
        id="decision-note"
        rows="3"
        [value]="decisionNote()"
        (input)="decisionNote.set(($any($event.target).value || ''))"
      ></textarea>
    </div>

    <div class="actions">
      <button
        type="button"
        class="button button-success"
        (click)="submitDecision(true)"
        [disabled]="verifying() || object()?.status === 'verified'"
      >
        @if (object()?.status === 'verified') {
          {{ 'share.alreadyVerified' | translate }}
        } @else if (verifying()) {
          {{ 'share.verifying' | translate }}
        } @else {
          {{ 'share.markDone' | translate }}
        }
      </button>

      <button
        type="button"
        class="button button-error"
        (click)="submitDecision(false)"
        [disabled]="verifying() || object()?.status === 'verified'"
      >
        @if (verifying()) {
          {{ 'share.verifying' | translate }}
        } @else {
          {{ 'share.reject' | translate }}
        }
      </button>
    </div>

    @if (success()) {
      <p class="success">{{ 'share.success' | translate }}</p>
    }
    @if (actionError()) {
      <p class="error">{{ actionError() | translate }}</p>
    }
  }
</div>

